/*
Multiple background CSS Parser for IE6/7/8, Firefox <=3.5
Author: Ben Green (bgreen@chicowebdesign.com)
Date: 101117
License: Free
*/
jQuery(function(f){if((f.browser.msie&&parseFloat(f.browser.version)>=6&&parseFloat(f.browser.version)<9)||(f.browser.mozilla&&parseInt(f.browser.version.substr(0,1))<=1&&parseInt(f.browser.version.substr(2,1))<=9&&parseInt(f.browser.version.substr(4,1))<=1)){var b={};var e=new Array("input");f.fn.addLayer=function(t,s,u){f(this).each(function(){var w=f(this).extend({},u||{});if(s){var z=f(this);z.wrap('<div class="add_background_outer" />');$last=z.parent();$last.css({margin:z.css("margin"),display:z.css("display"),position:z.css("position"),top:z.css("top"),left:z.css("left"),right:z.css("right"),bottom:z.css("bottom"),"float":z.css("float"),clear:z.css("clear"),"z-index":z.css("z-index"),height:parseFloat(z.css("height").replace("px",""))+parseFloat(z.css("padding-top").replace("px",""))+parseFloat(z.css("padding-bottom").replace("px","")),width:parseFloat(z.css("width").replace("px",""))+parseFloat(z.css("padding-left").replace("px",""))+parseFloat(z.css("padding-right").replace("px","")),"-moz-border-radius-bottomright":z.css("-moz-border-radius-bottomright"),"-moz-border-radius-bottomleft":z.css("-moz-border-radius-bottomleft"),"-moz-border-radius-topleft":z.css("-moz-border-radius-topleft"),"-moz-border-radius-topright":z.css("-moz-border-radius-topright"),background:t});z.css({margin:"",display:"",position:"",top:"",left:"",right:"",bottom:"","float":"","z-index":"",clear:"",height:"",width:"","-moz-border-radius-bottomright":"","-moz-border-radius-bottomleft":"","-moz-border-radius-topleft":"","-moz-border-radius-topright":""})}else{$last=(f(this).find(".add_background:last").length>0?f(this).find(".add_background:last"):f(this));var v=$last.html();if(f.browser.msie){$last.html('<div class="add_background">'+v+"</div>")}else{$last.empty().append('<div class="add_background">'+v+"</div>")}$last=f(this).find(".add_background:last");if((f.browser.msie&&parseFloat(f.browser.version)<8)&&(f(this).css("position")=="static")){$last.css({background:t})}else{$last.css({background:t,width:"100%",height:"100%"})}var y=$last.parent();var x=new Array(y.css("padding-top"),y.css("padding-right"),y.css("padding-bottom"),y.css("padding-left"),y.css("height"));if(f.browser.msie&&parseFloat(f.browser.version)<6){y.css("padding","0");$last.css({"padding-top":x[0],"padding-right":x[1],"padding-bottom":x[2],"padding-left":x[3]})}else{$last.css({"padding-top":x[0],"padding-right":x[1],"padding-bottom":x[2],"padding-left":x[3],"margin-top":"-"+x[0],"margin-right":"-"+x[1],"margin-bottom":"-"+x[2],"margin-left":"-"+x[3]});if(f.browser.msie&&parseInt(f.browser.version)<=7){$last.css({height:x[4]})}}if(w.insideCss){$last.css(w.insideCss)}if(w.insideClass){$last.addClass(w.insideClass)}}})};function r(u){var s=f(u);var w=s.parent();var v=new Array(s.css("padding-top"),s.css("padding-right"),s.css("padding-bottom"),s.css("padding-left"));var t=s.html();w.html(t);if(f.browser.msie&&parseFloat(f.browser.version)<6){w.css({"padding-top":v[0],"padding-right":v[1],"padding-bottom":v[2],"padding-left":v[3]})}}function j(t){var s=f(t);var u=f(s.children()[0]);u.css({margin:s.css("margin"),position:s.css("position"),top:s.css("top"),left:s.css("left"),right:s.css("right"),bottom:s.css("bottom"),"float":s.css("float"),clear:s.css("clear"),"z-index":s.css("z-index")});u.unwrap()}function a(u,t){var s=u.toLowerCase();var v=s.indexOf(t);while(v>-1){u=u.substr(0,v)+t+u.substr(v+t.length);v=s.indexOf(t,v+1)}return u}function l(v,t){v=v.replace(">"," ").replace("+"," ");var w=v.split(" ");var u=0;for(var x=0;x<w.length;x++){var B=f.trim(w[x]);var y=0;while(y>-1){function A(E){var C=10000;var F=-1;for(var D=0;D<E.length;D++){if((E[D]<C)&&(E[D]>-1)){C=E[D];F=D}}if(C==10000){C=-1}return{lowest:C,which:F}}var s=[B.indexOf("#",y),B.indexOf(".",y),B.indexOf(":",y)];var z=A(s);if(y==0&&z.lowest>0){u+=1;y++}else{if(y==0&&z.lowest==-1){u+=1;break}else{if(z.lowest>-1){if(z.which==0){u+=100}if(z.which==1){u+=10}if(z.which==2){u+=10}y=z.lowest+1}else{if(y==0){u+=1}else{break}}}}}}return u+(t?1000:0)}function c(u){var v=u.indexOf("(");while(v>-1){var s=u.indexOf(")",v+1);var t=u.substr(v,s-v).replace(/,/g,"##comma##");u=u.substr(0,v)+t+u.substr(s);v=u.indexOf("(",s+1)}return u}function q(G,s,F){var u={};G=G.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"");var D=G.indexOf(s);while(D>-1){var E=a(f.trim(G.substr(G.indexOf(":",D+1)+1,G.indexOf(";",D+1)-G.indexOf(":",D+1)-1)),"url(");E=c(E);if(E.indexOf(",")>-1){if(F){var z=E.indexOf("url(");while(z>-1){if(E.substr(z+4,7).toLowerCase()!="http://"){var x=(E.substr(z+4,1)=="/");var w=document.URL.substr(0,document.URL.indexOf("/",9));E=E.substr(0,z+4)+(x?w:F)+E.substr(z+4)}z=E.indexOf("url(",z+1)}}var t=E.length;E=E.replace("!important","");t=(t==E.length?false:true);var C=G.lastIndexOf("}",D)+1;if(G.lastIndexOf(";",D)+1>C){C=G.lastIndexOf(";",G.lastIndexOf("{",D))+1}if(C==-1){C=0}var v=f.trim(G.substr(C,G.lastIndexOf("{",D)-C));var B=v.split(",");for(var y=0;y<B.length;y++){var A=f.trim(B[y]);A=a(A,":active");A=a(A,":hover");A=a(A,":focus");u[A]={property:s,value:E,selScore:l(A,t)}}}D=G.indexOf(s,G.indexOf(";",D+1))}f.extend(b,u)}function o(t,s){f(t).each(function(){var u=f(this);u.css("background","none");var z=u.attr("jQueryMultipleBgCurSelector");var y=u.attr(s);u.attr("jQueryMultipleBgCurSelector",y);vals=b[y].value.split(",");for(var v=vals.length-1;v>=0;v--){vals[v]=f.trim(vals[v].replace(/##comma##/g,","))}if(m(e,this.tagName.toLowerCase())){var w=u.parent();while(w.parent().hasClass("add_background_outer")){w=w.parent()}for(var v=vals.length-1;v>=0;v--){if(!w.hasClass("add_background_outer")){u.addLayer(vals[v],true)}else{w.css("background",vals[v]);w=f(w.children()[0])}}while(w.hasClass("add_background_outer")){var A=w;w=f(w.children()[0]);j(A)}}else{var x=u.find(".add_background").length;var w=f(u.children(".add_background")[0]);for(var v=vals.length-1;v>=0;v--){if(w.length<1){u.addLayer(vals[v],false)}else{w.css("background",vals[v]);w=f(w.children(".add_background")[0])}}while(w.length){var A=w;w=f(w.children(".add_background")[0]);r(A)}}})}function g(s){if(f(this).attr("jQueryMultipleBgCurSelector")!=f(this).attr("jQueryMultipleBgActiveSelector")){o(this,"jQueryMultipleBgHoverSelector")}}function i(s){o(this,"jQueryMultipleBgStaticSelector")}function p(s){o(this,"jQueryMultipleBgActiveSelector")}function k(s){if(f(this).attr("jQueryMultipleBgHoverSelector")){o(this,"jQueryMultipleBgHoverSelector")}else{o(this,"jQueryMultipleBgStaticSelector")}}function n(s){o(this,"jQueryMultipleBgFocusSelector")}function d(s){o(this,"jQueryMultipleBgStaticSelector")}function m(v,u,s){var t;for(t=0;t<v.length;t++){if(s){if(v[t].toLowerCase()==u.toLowerCase()){return true}}else{if(v[t]==u){return true}}}return false}function h(s){if(s==undefined){s=document}for(var v in b){var t=v.toLowerCase();if((t.indexOf(":hover")>-1)||(t.indexOf(":active")>-1)||(t.indexOf(":focus")>-1)){var u,w;if(t.indexOf(":hover")>-1){u=v.substr(0,t.indexOf(":hover"));w=v.substr(t.indexOf(":hover")+6);f(u+w,s).each(function(){var x=f(this).attr("jQueryMultipleBgHoverSelector");if((x)&&(!m(f(a(x,":hover").replace(/:hover/g,"")),this))){x=undefined}if((!x)||(b[x].selScore<b[v].selScore)){f(this).attr("jQueryMultipleBgHoverSelector",v);if(!x){f(this).hover(g,i)}}})}else{if(t.indexOf(":active")>-1){u=v.substr(0,t.indexOf(":active"));w=v.substr(t.indexOf(":active")+7);f(u+w,s).each(function(){var x=f(this).attr("jQueryMultipleBgActiveSelector");if((x)&&(!m(f(a(x,":active").replace(/:active/g,"")),this))){x=undefined}if((!x)||(b[x].selScore<b[v].selScore)){f(this).attr("jQueryMultipleBgActiveSelector",v);if(!x){f(this).mousedown(p).mouseup(k)}}})}else{if(t.indexOf(":focus")>-1){u=v.substr(0,t.indexOf(":focus"));w=v.substr(t.indexOf(":focus")+6);f(u+w,s).each(function(){var x=f(this).attr("jQueryMultipleBgFocusSelector");if((x)&&(!m(f(a(x,":focus").replace(/:focus/g,"")),this))){x=undefined}if((!x)||(b[x].selScore<b[v].selScore)){f(this).attr("jQueryMultipleBgFocusSelector",v);if(!x){f(this).focus(n).blur(d)}}})}}}}else{f(v,s).each(function(){var x=f(this).attr("jQueryMultipleBgStaticSelector");if(!m(f(x),this)){x=undefined}if((!x)||(b[x].selScore<b[v].selScore)){f(this).attr("jQueryMultipleBgStaticSelector",v);o(this,"jQueryMultipleBgStaticSelector")}})}}}jQuery.fn.extend({multipleBgReadCss:q,multipleBgApplyCss:h,multipleBgApplyBg:o,multipleBgRules:b});f("style").each(function(){var s=f(this).html();q(s,"background",false)});f("link[rel=stylesheet]").each(function(){var s=f(this).attr("href");if(s.substr(0,7).toLowerCase()!="http://"){var t=s.slice(0,s.lastIndexOf("/")+1);f.ajax({async:false,url:f(this).attr("href"),success:function(u){q(u,"background",t)}})}});h()}else{jQuery.fn.extend({multipleBgReadCss:function(s,u,t){return false},multipleBgApplyCss:function(s){return false},multipleBgApplyBg:function(t,s){return false},multipleBgRules:{}})}});
